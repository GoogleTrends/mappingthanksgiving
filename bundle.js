!function(t){function e(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function a(){var t=p.node().offsetWidth;y!==t&&(y=t,s.default.resize(),f.default.resize())}var i=n(1),o=r(i),u=n(3),c=r(u),l=n(4),s=r(l),d=n(6),f=r(d),p=d3.select("body"),y=0;!function(){p.classed("is-mobile",c.default.any()),window.addEventListener("resize",(0,o.default)(a,150)),s.default.init(),f.default.init()}()},function(t,e,n){(function(e){function n(t,e,n){function a(e){var n=g,r=v;return g=v=void 0,L=e,h=t.apply(r,n)}function i(t){return L=t,b=setTimeout(s,e),O?a(t):h}function c(t){var n=t-w,r=t-L,a=e-n;return A?_(a,m-r):a}function l(t){var n=t-w,r=t-L;return void 0===w||n>=e||n<0||A&&r>=m}function s(){var t=x();if(l(t))return d(t);b=setTimeout(s,c(t))}function d(t){return b=void 0,j&&g?a(t):(g=v=void 0,h)}function f(){void 0!==b&&clearTimeout(b),L=0,g=w=v=b=void 0}function p(){return void 0===b?h:d(x())}function y(){var t=x(),n=l(t);if(g=arguments,v=this,w=t,n){if(void 0===b)return i(w);if(A)return b=setTimeout(s,e),a(w)}return void 0===b&&(b=setTimeout(s,e)),h}var g,v,m,h,b,w,L=0,O=!1,A=!1,j=!0;if("function"!=typeof t)throw new TypeError(u);return e=o(e)||0,r(n)&&(O=!!n.leading,A="maxWait"in n,m=A?k(o(n.maxWait)||0,e):m,j="trailing"in n?!!n.trailing:j),y.cancel=f,y.flush=p,y}function r(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function a(t){return!!t&&"object"==typeof t}function i(t){return"symbol"==typeof t||a(t)&&b.call(t)==l}function o(t){if("number"==typeof t)return t;if(i(t))return c;if(r(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=r(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(s,"");var n=f.test(t);return n||p.test(t)?y(t.slice(2),n?2:8):d.test(t)?c:+t}var u="Expected a function",c=NaN,l="[object Symbol]",s=/^\s+|\s+$/g,d=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,p=/^0o[0-7]+$/i,y=parseInt,g="object"==typeof e&&e&&e.Object===Object&&e,v="object"==typeof self&&self&&self.Object===Object&&self,m=g||v||Function("return this")(),h=Object.prototype,b=h.toString,k=Math.max,_=Math.min,x=function(){return m.Date.now()};t.exports=n}).call(e,n(2))},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={android:function(){return navigator.userAgent.match(/Android/i)},blackberry:function(){return navigator.userAgent.match(/BlackBerry/i)},ios:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},opera:function(){return navigator.userAgent.match(/Opera Mini/i)},windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return r.android()||r.blackberry()||r.ios()||r.opera()||r.windows()}};e.default=r},function(t,e,n){"use strict";function r(t){return t.map(function(t){return c({},t,{order:+t.order})})}function a(t){return t.map(function(t){return c({},t,{hourNumber:+t.hourNumber,scaled:+t.scaled})})}function i(t){d3.loadData("assets/data/overindexed.csv","assets/data/searchTiming.csv",function(e,n){d={overindexed:r(n[0]),searchTiming:a(n[1])},t()})}function o(){f.resize(),p.resize(),y.resize()}function u(){i(function(){var t=d3.select("#food"),e=t.select(".graphic__chart");f=(0,s.default)("graphic1",d),e.call(f);var n=d3.select("#entertainment"),r=n.select(".graphic__chart");p=(0,s.default)("graphic2",d),r.call(p);var a=d3.select("#shopping"),i=a.select(".graphic__chart");y=(0,s.default)("graphic3",d),i.call(y)})}Object.defineProperty(e,"__esModule",{value:!0});var c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},l=n(5),s=function(t){return t&&t.__esModule?t:{default:t}}(l),d={},f=null,p=null,y=null;e.default={init:u,resize:o}},function(t,e,n){"use strict";function r(t,e){function n(t,e){return"translate("+t+", "+e+")"}function r(t){b=h.overindexed,k=h.searchTiming;var e=b.filter(function(e){return e.Category==t});_=d3.nest().key(function(t){return t.metro}).rollup(function(t){return{day:d3.nest().key(function(t){return t.Day}).entries(t)}}).entries(e),x=d3.nest().key(function(t){return t.metro}).rollup(function(t){return{gcid:d3.nest().key(function(t){return t.gcid}).entries(t)}}).entries(k);var n=_.filter(function(t){return t.key===w});"food"===t?L="Thursday":"shopping"===t?L="Friday":"entertainment"===t&&(L="Overall");var r=n[0].value.day.filter(function(t){return t.key===L}),a=r[0].values,i=a.map(function(t){return t.gcid}),o=x.filter(function(t){return t.key===w});O=o[0].value.gcid.filter(function(t){return i.includes(t.key)})}function a(t){var e=_.filter(function(t){return t.key===w}),n=e[0].value.day.filter(function(t){return t.key===L});if(p(),n.length){var r=n[0].values,a=r.map(function(t){return t.gcid}),i=x.filter(function(t){return t.key===w});O=i[0].value.gcid.filter(function(t){return a.includes(t.key)}),g()}else y()}function i(t){var e=t.attr("data-category"),n=d3.select("#"+e);n.select(".metroGraphic__ui").append("div").attr("class","ui__item ui__item--dropdown dropdown__metro tk-product"),n.select(".dayGraphic__ui").append("div").attr("class","ui__item ui__item--dropdown dropdown__day tk-product")}function o(t){var e=t.attr("data-category"),n=d3.select("#"+e),r=n.select(".dropdown__metro"),i=r.append("select"),o=n.select(".dropdown__day"),u=o.append("select");i.selectAll("option").data(_).enter().append("option").attr("value",function(t){return t.key}).property("selected",function(t){return t.key==w}).text(function(t){return t.key}),i.on("change",function(){w=this.value,a(w)});var c=_.filter(function(t){return t.key==w}),l=d3.map(I,function(t){return t.number});u.data(c).selectAll("option").data(function(t){return t.value.day}).enter().append("option").attr("value",function(t){return t.key}).text(function(t){return l.get(t.key).day}).property("selected",function(t){return t.key==L}),u.on("change",function(){L=this.value,a(L)})}function u(){var t=W.append("g").attr("class","g-plot");t.append("g").attr("class","g-highlights").append("rect").attr("class","rectHighlight");var e=t.append("g").attr("class","g-annotations");e.append("text").attr("class","annotationLabel tk-product"),e.append("line").attr("class","annotationLine");var n=(e.append("defs").append("marker").attr("id","arrow").attr("refX",3).attr("refY",3).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto-start-reverse").append("path").attr("d","M 3 3L 3.35355 3.35355L 3.70711 3L 3.35355 2.64645L 3 3ZM -0.353553 0.353553L 2.64645 3.35355L 3.35355 2.64645L 0.353553 -0.353553L -0.353553 0.353553ZM 2.64645 2.64645L -0.353553 5.64645L 0.353553 6.35355L 3.35355 3.35355L 2.64645 2.64645Z"),t.append("g").attr("class","g-axis"));n.append("g").attr("class","axis axis--x");t.append("g").attr("class","g-sparklines"),t.append("g").attr("class","g-labels"),t.append("g").attr("class","g-axisLabels")}function c(){var t=W.append("defs"),e=t.append("linearGradient").attr("id","svgGradient").attr("x1","0%").attr("x2","0%").attr("y1","0%").attr("y2","100%");e.append("stop").attr("class","start").attr("offset","0%").attr("stop-color",F).attr("stop-opacity",1),e.append("stop").attr("class","end").attr("offset","100%").attr("stop-color",P).attr("stop-opacity",1)}function l(){z=T.node().offsetWidth,G=window.innerHeight,A=z<600,N=A?10:11,j=3*N,Y=A?3.5*N:2.5*N,C={top:5*N,left:A?N:75,bottom:2*j,right:A?N:75},B=z-C.right-C.left,S=A?6*j+6*Y+C.bottom:5*j+4*Y+C.bottom+C.top,M=A?0:.35*B-2*C.right}function s(){var t=A?B-C.right/2:.7*B;$.range([j,0]).domain([0,100]),E.range([0,t]).domain([1,72])}function d(){var t=T.selectAll(".g-axis"),e=[12,24,36,48,60],n=d3.axisBottom(E).tickValues(e).tickSize(-S+2*C.bottom-(j+N)).tickFormat(function(t){return{12:"noon",24:"midnight",36:"noon",48:"midnight",60:"noon"}[t]});t.select(".axis--x").attr("transform","translate("+M+", "+(S-C.bottom-Y)+")").call(n)}function f(){var t=T.select(".g-axisLabels").attr("transform","translate("+M+", "+(S-(j+Y))+")"),e=t.selectAll(".axis--label").data([{label:"Wednesday",value:12},{label:"Thanksgiving",value:36},{label:"Black Friday",value:60}]),n=e.enter().append("text").attr("class","axis--label tk-product");e.exit().remove(),n.merge(e).text(function(t){return t.label}).style("text-anchor","middle").attr("x",function(t){return E(t.value)})}function p(){H.classed("is-visible",!1)}function y(){H.classed("is-visible",!0)}function g(){var t=this;W.attr("width",B).attr("height",S);var e=W.select(".g-plot");e.attr("transform",n(C.left,C.top)),Z.x(function(t){return E(+t.hourNumber)}).y(function(t){return $(+t.scaled)});var r=A?-N:N;if("Overall"!=L){e.select(".rectHighlight").attr("transform","translate("+M+", "+r+")").attr("opacity",0).attr("x",function(t){return E("Wednesday"==L?0:"Thursday"==L?24:48)}).attr("y",-N).attr("width",E(24)-E(0)).attr("height",S-2*C.bottom+Y).transition().duration(500).attr("opacity",.15)}else e.selectAll(".rectHighlight").attr("opacity",0);var a=e.select(".g-sparklines").attr("transform","translate("+M+", "+r+")"),i=a.selectAll(".sparkline").data(O,function(t){return t.key}),o=i.enter().append("path").attr("class",function(t,e){return"sparkline sparkline__"+e}).attr("stroke","url(#svgGradient)");i.exit().remove(),o.merge(i).attr("transform","translate(0, "+S+")").transition().duration(500).delay(function(t,e){return 100*e}).attr("d",function(e){return e.line=t,Z(e.values)}).attr("transform",function(t,e){return n(0,2*Y*e)});var u=e.select(".g-labels").attr("transform","translate(0, "+(N+C.top)+")"),c=u.selectAll(".lineLabel").data(O),l=c.enter().append("text").attr("class","lineLabel tk-product");c.exit().remove(),l.merge(c).attr("transform","translate("+-C.left+", "+S+")").transition().duration(500).delay(function(t,e){return 100*e}).text(function(t,e){return e+1+". "+t.key.replace(/_/g," ")}).style("text-anchor","start").attr("transform",function(t,e){return"translate("+-C.left+", "+(2*Y*e-1.5*N)+")"});e.select(".annotationLabel").text("Timing of Searches in "+w).style("text-anchor","end").attr("transform","translate("+(E(26)+.35*B-2*C.right)+", "+-2*N+")"),e.select(".annotationLine").attr("x1",E(28)).attr("x2",E(32)).attr("y1",S-6*N-N/3).attr("y2",S-6*N-N/3).attr("marker-end","url(#arrow)").attr("transform","translate("+(.35*B-2*C.right)+", "+(-S+(j+N))+")")}function v(t){T=t,W=t.select("svg"),H=T.select(".chart__message"),H.on("click",p),D=t.attr("data-category"),r(D),i(t),o(t),u(),c(),m()}function m(){l(),s(),d(),f(),g()}var h=e,b=null,k=null,_=null,x=null,w="New York",L=null,O=null,A=null,j=null,M=null,T=null,W=null,H=null,D=null,F="#F15822",P="#dddddd",z=0,G=0,B=0,S=0,N=12,E=d3.scaleLinear(),$=d3.scaleLinear(),C=null,Y=null,Z=d3.line(),I=[{number:"Wednesday",day:"Wednesday"},{number:"Thursday",day:"Thanksgiving"},{number:"Friday",day:"Black Friday"},{number:"Overall",day:"Overall Holiday"}];return v.resize=m,v}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";function r(t){return t.map(function(t){return k({},t,{Day:+t.Day,Hour:+t.Hour,scaled:+t.scaled})})}function a(t){d3.loadData("assets/data/traffic.csv","assets/data/bestWorstTraffic.csv",function(e,n){_={traffic:r(n[0]),bestWorstTraffic:n[1]},t()})}function i(t,e){return"translate("+t+", "+e+")"}function o(){x=_.traffic,w=_.bestWorstTraffic,L=d3.nest().key(function(t){return t.Metro}).sortKeys(d3.ascending).rollup(function(t){return{day:d3.nest().key(function(t){return t.Day}).entries(t)}}).entries(x),O=d3.nest().key(function(t){return t.Metro}).sortKeys(d3.ascending).rollup(function(t){return{when:d3.nest().key(function(t){return t.When}).entries(t)}}).entries(w)}function u(){Z.select(".metroGraphic__ui").append("div").attr("class","ui__item ui__item--dropdown dropdown__metro"),Z.select(".dayGraphic__ui").append("div").attr("class","ui__item ui__item--dropdown dropdown__day")}function c(){var t=Z.select(".dropdown__metro"),e=t.append("select"),n=Z.select(".dropdown__day"),r=n.append("select");e.selectAll("option").data(L).enter().append("option").attr("value",function(t){return t.key}).property("selected",function(t){return t.key==A}).text(function(t){return t.key}),e.on("change",function(){A=this.value,s(A)}),Z.select("#daytime__checkbox").on("change",function(){s(A)});var a=d3.map(R,function(t){return t.number});r.data(L).selectAll("option").data(function(t){return t.value.day}).enter().append("option").attr("value",function(t){return+t.key}).property("selected",function(t){return t.key==j}).text(function(t){return a.get(+t.key).day}),r.on("change",function(){j=+this.value,s(j)})}function l(t,e){var n=O.filter(function(t){return t.key===A}),r=n[0].value.when[t].values,a=d3.select("#daytime__checkbox").property("checked");return"b"===e?r.filter(function(t){return 1==a?"TRUE"==t.Daylight:"FALSE"==t.Daylight}):r.filter(function(t){return"w"==t.Rank})}function s(t){var e=(O.filter(function(t){return t.key===A}),L.filter(function(t){return t.key===A})),n=e[0].value.day.filter(function(t){return+t.key===j});M=n;var r=l(0,"b"),a=(Z.select("#bestBefore").data(r).text(function(t){return t.Day+" "+t.Hour}),l(0,"w")),i=(Z.select("#worstBefore").data(a).text(function(t){return t.Day+" "+t.Hour}),l(1,"b")),o=(Z.select("#bestAfter").data(i).text(function(t){return t.Day+" "+t.Hour}),l(1,"w"));Z.select("#worstAfter").data(o).text(function(t){return t.Day+" "+t.Hour}),Z.select("#selectedMetro").text(A);p(),v()}function d(){var t=K.append("g").attr("class","g-plot"),e=t.append("g").attr("class","g-axis");e.append("g").attr("class","axis axis--x");t.append("g").attr("class","g-sparkline"),t.append("g").attr("class","g-labels"),t.append("g").attr("class","g-axisLabels")}function f(){var t=K.append("defs"),e=t.append("linearGradient").attr("id","svgGradient").attr("x1","0%").attr("x2","0%").attr("y1","0%").attr("y2","100%");e.append("stop").attr("class","start").attr("offset","0%").attr("stop-color",H).attr("stop-opacity",1),e.append("stop").attr("class","end").attr("offset","100%").attr("stop-color",D).attr("stop-opacity",1)}function p(){F=I.node().offsetWidth,P=window.innerHeight,T=F<600,B=T?10:11,W=8*B,$=2.5*B,E={top:B,left:T?50:100,bottom:2*B,right:T?50:100},z=F,G=W+(E.bottom+E.top)}function y(){var t=z-E.left-E.right;E.top,E.bottom;N.range([W,0]).domain([0,100]),S.range([0,t]).domain([0,23])}function g(){var t=I.selectAll(".g-axis"),e=[0,6,12,18,23],n=d3.axisBottom(S).tickValues(e).tickSize(G-2.5*B).tickFormat(function(t){return{0:"midnight",6:"6 AM",12:"noon",18:"6 PM",23:"11 PM"}[t]});t.select(".axis--x").call(n)}function v(){K.attr("width",z).attr("height",G);var t=K.select(".g-plot");t.attr("transform",i(E.left,E.top)),C.x(function(t){return S(t.Hour)}).y(function(t){return N(t.scaled)});var e=t.select(".g-sparkline"),n=e.selectAll(".sparkline__traffic").data(M),r=n.enter().append("path").attr("class","sparkline__traffic").attr("stroke","url(#svgGradient)");n.exit().remove(),r.merge(n).transition().duration(500).attr("d",function(t){return C(t.values)})}function m(){p(),y(),g(),v()}function h(){o(),u(),c(),s(A),d(),f(),m()}function b(){a(h)}Object.defineProperty(e,"__esModule",{value:!0});var k=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_={},x=null,w=null,L=null,O=null,A="New York",j=4,M=null,T=null,W=null,H="#F3A25A",D="#56CCF2",F=0,P=0,z=0,G=0,B=12,S=d3.scaleLinear(),N=d3.scaleLinear(),E=null,$=null,C=d3.line(),Y=d3.select("body"),Z=Y.select("#traffic"),I=Z.select(".graphic__chart"),K=I.select("svg"),R=[{number:1,day:"Monday"},{number:2,day:"Tuesday"},{number:3,day:"Wednesday"},{number:4,day:"Thanksgiving"},{number:5,day:"Black Friday"},{number:6,day:"Saturday"},{number:7,day:"Sunday"}];e.default={init:b,resize:m}}]);